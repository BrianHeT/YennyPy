{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

<div class="profile-container edit">
    <div class="profile-card">
        
        <!-- Encabezado de la Tarjeta -->
        <div class="profile-card-header">
            <h3>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.38-2.828-2.828z" />
                </svg>
                Editar Perfil
            </h3>
        </div>
        
        <!-- Cuerpo y Formulario -->
        <div class="profile-card-body">
            
            <!-- Mensajes de Error -->
            {% if form.errors %}
                <div class="flash-message error" role="alert">
                    <strong>¡Error!</strong> Por favor, corrige los siguientes errores:
                    <ul style="margin-bottom: 0; margin-top: 0.5rem; list-style: disc; padding-left: 1.5rem;">
                        {% for field, errors in form.errors.items() %}
                            {% for error in errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}

            <!-- Formulario de Actualización -->
            <form method="POST" action="{{ url_for('auth.edit_profile') }}">
                {{ form.hidden_tag() }}
                
                <h5 class="profile-form-section-title">Información Personal</h5>
                
                <!-- Campo Nombre -->
                <div class="profile-form-group">
                    {{ form.name.label }}
                    {{ form.name(required=True) }}
                </div>

                <!-- Campo Email -->
                <div class="profile-form-group">
                    {{ form.email.label }}
                    {{ form.email(required=True) }}
                </div>

                <div class="profile-divider"></div>

                <h5 class="profile-form-section-title">Cambiar Contraseña</h5>
                <p class="profile-form-hint">Deja los campos de contraseña vacíos si no quieres cambiarla.</p>

                <!-- Contraseña Actual -->
                <div class="profile-form-group">
                    {{ form.current_password.label }}
                    {{ form.current_password(placeholder="Solo si vas a cambiar la contraseña") }}
                </div>

                <!-- Nueva Contraseña -->
                <div class="profile-form-group">
                    {{ form.new_password.label }}
                    {{ form.new_password(placeholder="Mínimo 8 caracteres") }}
                </div>

                <!-- Confirmar Nueva Contraseña -->
                <div class="profile-form-group">
                    {{ form.confirm_new_password.label }}
                    {{ form.confirm_new_password(placeholder="Repite la nueva contraseña") }}
                </div>

                <div class="profile-divider"></div>

                <!-- Botones de Acción -->
                <div class="profile-actions">
                    <a href="{{ url_for('auth.profile') }}" class="btn-profile secondary">
                        <i class="fas fa-arrow-left"></i> Cancelar
                    </a>
                    
                    {{ form.submit(class="btn-profile success") }}
                </div>
            </form>
        </div>
    </div>
    
    <!-- Información adicional -->
    <div class="profile-info-box">
        <h6>
            <i class="fas fa-info-circle"></i> Información Importante
        </h6>
        <ul>
            <li><i class="fas fa-check"></i> Tu email se usa para notificaciones importantes</li>
            <li><i class="fas fa-check"></i> Las contraseñas deben tener al menos 8 caracteres</li>
            <li><i class="fas fa-check"></i> Tus datos están protegidos y encriptados</li>
        </ul>
    </div>
</div>
{% endblock content %}
