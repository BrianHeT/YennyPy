{% include 'components/nav.html' %}

{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="h4 mb-0">Biblioteca</h2>
    {% if current_user.is_authenticated and current_user.is_admin %}
      <a href="{{ url_for('books.create_book') }}" class="btn btn-outline-primary">+ Publicar libro</a>
    {% endif %}
  </div>

  <div class="row g-3">
    {% for book, image_url in books %}
    <div class="col-12 col-md-6 col-lg-4">
      <div class="card border-0 shadow-sm">
        {% if image_url %}
          <img src="{{ image_url }}" class="card-img-top" alt="{{ book.title }}" style="height:220px;object-fit:cover;">
        {% else %}
          <div style="height:220px;background:#f5f5f5;display:flex;align-items:center;justify-content:center;color:#999;">
            Sin imagen
          </div>
        {% endif %}
        <div class="card-body p-3">
          <h5 class="card-title mb-1">{{ book.title }}</h5>
          <p class="small text-muted mb-2">Por {{ book.author_name }}</p>
          <p class="mb-2">{{ book.synopsis|truncate(120) }}</p>
          <div class="d-flex justify-content-between align-items-center">
            <a href="{{ url_for('books.details', book_id=book.id) }}" class="btn btn-sm btn-outline-secondary">Ver</a>
            <span class="text-muted small">{{ book.quantity }} en stock</span>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock %}
{% include 'components/footer.html' %}
